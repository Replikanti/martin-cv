<!doctype html>
<html lang="cs">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Martin Holý – Release orchestration · Automation</title>
  <meta name="description" content="Osobní kariérní stránka – profil, zkušenosti, projekty, dovednosti a kontakt." />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link rel="icon" href="/favicon.ico" sizes="any">
  <link rel="icon" type="image/svg+xml" href="/favicon.svg">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  <link rel="manifest" href="/site.webmanifest">
  <meta name="theme-color" content="#0B1F3B">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #0b0d10;
      --panel: #12161b;
      --text: #e5e7eb;
      --muted: #a8b3c1;
      --brand: #7c3aed;
      --brand-2: #06b6d4;
      --ring: 0 0 0 3px rgba(124, 58, 237, .35);
      --radius: 16px;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
    }
    @media (prefers-color-scheme: light) {
      :root {
        --bg: #f7f7f9;
        --panel: #ffffff;
        --text: #0f172a;
        --muted: #475569;
        --brand: #7c3aed;
        --brand-2: #0891b2;
        --shadow: 0 8px 20px rgba(2,6,23,.08);
      }
    }

    *, *::before, *::after { box-sizing: border-box; }
    html { scroll-behavior: smooth; }
    body {
      margin: 0;
      background: radial-gradient(1200px 800px at 80% -10%, rgba(124,58,237,.12), transparent 55%), radial-gradient(900px 600px at 10% 110%, rgba(6,182,212,.12), transparent 55%), var(--bg);
      color: var(--text);
      font: 16px/1.6 system-ui, -apple-system, 'Segoe UI', 'Inter', Roboto, Helvetica, Arial, 'Apple Color Emoji', 'Segoe UI Emoji';
    }
    a { color: inherit; text-decoration: none; }
    img { max-width: 100%; display: block; }
    .container { width: min(1120px, 92%); margin: 0 auto; }
    .grid { display: grid; gap: 24px; }

    header {
      position: sticky;
      top: 0;
      z-index: 50;
      backdrop-filter: saturate(140%) blur(10px);
      background: color-mix(in oklab, var(--bg) 85%, transparent);
      border-bottom: 1px solid color-mix(in oklab, var(--text) 12%, transparent);
    }
    .nav {
      display: flex;
      align-items: center;
      justify-content: space-between;
      height: 64px;
    }
    .brand {
      display: flex;
      align-items: center;
      gap: 12px;
      font-weight: 700;
      letter-spacing: .2px;
    }
    .logo {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      display: grid;
      place-items: center;
      font-weight: 800;
      background: linear-gradient(135deg, var(--brand), var(--brand-2));
      box-shadow: var(--shadow);
    }
    nav ul {
      list-style: none;
      display: flex;
      gap: 18px;
      padding: 0;
      margin: 0;
    }
    nav a {
      opacity: .85;
      padding: 8px 10px;
      border-radius: 10px;
    }
    nav a:focus, nav a:hover {
      outline: none;
      box-shadow: var(--ring);
      background: color-mix(in oklab, var(--panel) 92%, transparent);
      opacity: 1;
    }
    .actions {
      display: flex;
      gap: 10px;
      align-items: center;
    }
    .btn {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      padding: 10px 14px;
      border-radius: 12px;
      border: 1px solid transparent;
      background: color-mix(in oklab, var(--panel) 85%, transparent);
      color: var(--text);
      cursor: pointer;
    }
    .btn:hover {
      border-color: color-mix(in oklab, var(--text) 12%, transparent);
    }
    .btn.primary {
      background: linear-gradient(135deg, var(--brand), var(--brand-2));
      font-weight: 600;
    }

    .hero-inner {
      display: grid;
      grid-template-columns: minmax(0,1.6fr) minmax(0,1fr);
      gap: 32px;
      align-items: center;
    }
    .hero-aside {
      display: grid;
      gap: 12px;
      align-content: start;
    }
    .kicker {
      color: var(--muted);
      font-weight: 700;
      letter-spacing: .4px;
      text-transform: uppercase;
      font-size: .85rem;
    }
    .gradtext {
      background: linear-gradient(90deg, var(--brand), var(--brand-2));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }
    .h1-underline {
      height: 4px;
      width: 140px;
      background: linear-gradient(90deg, var(--brand), var(--brand-2));
      border-radius: 999px;
      margin: 12px 0 8px;
    }
    h1 {
      font-size: clamp(32px, 5vw, 56px);
      line-height: 1.1;
      margin: 10px 0 12px;
    }
    .lead {
      font-size: clamp(16px, 1.7vw, 20px);
      color: var(--muted);
      margin-bottom: 22px;
    }
    .lead.accent {
      background: linear-gradient(90deg, var(--brand), var(--brand-2));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }
    .hero-cta {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
    }
    .avatar {
      width: 180px;
      aspect-ratio: 1;
      border-radius: 24px;
      overflow: hidden;
      box-shadow: var(--shadow);
      border: 1px solid color-mix(in oklab, var(--text) 12%, transparent);
    }
    .avatar img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .hero-card {
      background: linear-gradient(180deg, color-mix(in oklab, var(--panel) 70%, transparent), color-mix(in oklab, var(--panel) 96%, transparent));
      padding: 24px;
      border-radius: var(--radius);
      display: grid;
      gap: 12px;
      border: 1px solid color-mix(in oklab, var(--text) 10%, transparent);
    }

    section {
      padding: 64px 0;
    }
    .section-title {
      font-size: clamp(22px, 2.6vw, 32px);
      margin: 0 0 8px;
    }
    .section-sub {
      color: var(--muted);
      margin-top: 0;
    }

    .cards {
      display: grid;
      gap: 18px;
      grid-template-columns: 1fr;
    }
    @media (min-width: 700px) {
      .cards {
        grid-template-columns: repeat(2, 1fr);
      }
    }
    @media (min-width: 1400px) {
      .cards {
        grid-template-columns: repeat(3, 1fr);
      }
    }
    .card {
      background: var(--panel);
      border: 1px solid color-mix(in oklab, var(--text) 10%, transparent);
      border-radius: var(--radius);
      padding: 18px;
      box-shadow: var(--shadow);
      transition: transform .2s ease;
    }
    .card:hover {
      transform: translateY(-2px);
    }
    .card h3 {
      margin: 6px 0 4px;
      font-size: 18px;
    }
    .card p {
      margin: 0;
      color: var(--muted);
      font-size: .95rem;
    }

    .thumb {
      aspect-ratio: 16/9;
      border-radius: var(--radius);
      display: grid;
      place-items: center;
      font-weight: 600;
      letter-spacing: .3px;
      color: var(--text);
      margin-bottom: 10px;
      border: 1px solid color-mix(in oklab, var(--text) 10%, transparent);
    }
    .thumb--cicd {
      background: linear-gradient(135deg, #1f2937, #4b5563);
    }
    .thumb--k8s {
      background: linear-gradient(135deg, #0ea5e9, #6366f1);
    }
    .thumb--n8n {
      background: linear-gradient(135deg, #10b981, #06b6d4);
    }
    .thumb--backstage {
      background: linear-gradient(135deg, #7c3aed, #06b6d4);
    }

    .timeline {
      position: relative;
      margin-left: 12px;
    }
    .timeline::before {
      content: '';
      position: absolute;
      left: 12px;
      top: 0;
      bottom: 0;
      width: 2px;
      background: color-mix(in oklab, var(--text) 14%, transparent);
    }
    .step {
      position: relative;
      padding-left: 40px;
      margin: 24px 0;
    }
    .step::before {
      content: '';
      position: absolute;
      left: 4px;
      top: 5px;
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--brand), var(--brand-2));
      box-shadow: 0 0 0 4px color-mix(in oklab, var(--text) 8%, transparent);
    }
    .step h4 {
      margin: 0;
    }
    .badge {
      display: inline-block;
      padding: 4px 8px;
      font-size: 12px;
      border-radius: 999px;
      background: color-mix(in oklab, var(--text) 18%, transparent);
      color: var(--text);
      border: 1px solid color-mix(in oklab, var(--text) 22%, transparent);
    }
    .badges {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-top: 10px;
    }

    .skills {
      display: grid;
      grid-template-columns: repeat(12, 1fr);
      gap: 12px;
    }
    .skill {
      grid-column: span 6;
      background: var(--panel);
      border-radius: 999px;
      padding: 8px 12px;
      border: 1px solid color-mix(in oklab, var(--text) 10%, transparent);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .bar {
      height: 8px;
      border-radius: 999px;
      background: color-mix(in oklab, var(--text) 10%, transparent);
      overflow: hidden;
      flex: 1;
      margin-left: 12px;
    }
    .bar i {
      display: block;
      height: 100%;
      width: var(--value, 60%);
      background: linear-gradient(90deg, var(--brand), var(--brand-2));
    }

    form {
      display: grid;
      gap: 12px;
    }
    label {
      font-size: 14px;
      color: var(--muted);
    }
    input, textarea, select {
      width: 100%;
      padding: 12px 14px;
      border-radius: 12px;
      border: 1px solid color-mix(in oklab, var(--text) 12%, transparent);
      background: color-mix(in oklab, var(--panel) 92%, transparent);
      color: var(--text);
    }
    input:focus, textarea:focus, select:focus {
      outline: none;
      box-shadow: var(--ring);
      border-color: transparent;
    }
    textarea {
      min-height: 120px;
      resize: vertical;
    }
    .slots {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 8px;
    }
    .slot {
      padding: 10px 12px;
      border-radius: 10px;
      border: 1px solid color-mix(in oklab, var(--text) 14%, transparent);
      background: color-mix(in oklab, var(--panel) 85%, transparent);
      cursor: pointer;
      color: var(--text);
      font-weight: 600;
    }
    .slot[aria-pressed="true"], .slot:focus-visible {
      box-shadow: var(--ring);
      border-color: transparent;
    }

    .notice {
      margin-top: 14px;
      padding: 14px 16px;
      border-radius: 12px;
      background: color-mix(in oklab, var(--panel) 90%, transparent);
      border: 1px solid color-mix(in oklab, var(--brand) 35%, transparent);
      box-shadow: var(--shadow);
    }
    .notice--success {
      background: color-mix(in oklab, #10b981 8%, var(--panel) 92%);
      border-color: #10b981;
      color: var(--text);
    }
    .notice--error {
      background: color-mix(in oklab, #ef4444 8%, var(--panel) 92%);
      border-color: #ef4444;
      color: var(--text);
    }

    footer {
      padding: 36px 0 72px;
      color: var(--muted);
      border-top: 1px solid color-mix(in oklab, var(--text) 12%, transparent);
    }
    .social {
      display: flex;
      gap: 12px;
    }

    .modal {
      position: fixed;
      inset: 0;
      display: none;
      place-items: center;
      background: rgba(0,0,0,.45);
      z-index: 100;
    }
    .modal[open] {
      display: grid;
    }
    .dialog {
      width: min(360px, 92vw);
      background: var(--panel);
      border: 1px solid color-mix(in oklab, var(--text) 12%, transparent);
      border-radius: 16px;
      box-shadow: var(--shadow);
    }
    .cal-head {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 14px;
      border-bottom: 1px solid color-mix(in oklab, var(--text) 10%, transparent);
    }
    .cal-title {
      font-weight: 600;
    }
    .cal-grid {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 6px;
      padding: 12px;
    }
    .cal-day, .cal-dow {
      text-align: center;
      padding: 10px 0;
      border-radius: 10px;
    }
    .cal-dow {
      color: var(--muted);
      font-size: 12px;
    }
    .cal-day {
      border: 1px solid color-mix(in oklab, var(--text) 12%, transparent);
      background: color-mix(in oklab, var(--panel) 85%, transparent);
      cursor: pointer;
      color: var(--text);
      font-weight: 600;
    }
    .cal-day:hover, .cal-day:focus-visible {
      box-shadow: var(--ring);
      border-color: transparent;
    }
    .cal-day:disabled {
      opacity: .35;
      cursor: not-allowed;
    }
    .cal-actions {
      display: flex;
      justify-content: space-between;
      padding: 12px;
      gap: 8px;
      border-top: 1px solid color-mix(in oklab, var(--text) 10%, transparent);
    }
    .iconbtn {
      background: color-mix(in oklab, var(--panel) 90%, transparent);
      border: 1px solid color-mix(in oklab, var(--text) 12%, transparent);
      border-radius: 10px;
      padding: 8px 10px;
      cursor: pointer;
    }
    .iconbtn:hover, .iconbtn:focus-visible {
      box-shadow: var(--ring);
      border-color: transparent;
    }

    .muted {
      color: var(--muted);
    }
    .row {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      align-items: center;
    }
    .hidden {
      display: none !important;
    }

    .suggestions {
      position: absolute;
      background: var(--panel);
      border: 1px solid color-mix(in oklab, var(--text) 12%, transparent);
      border-radius: 12px;
      margin-top: 4px;
      max-height: 200px;
      overflow-y: auto;
      z-index: 10;
      box-shadow: var(--shadow);
    }
    .suggestion-item {
      padding: 10px 14px;
      cursor: pointer;
      color: var(--text);
      border-bottom: 1px solid color-mix(in oklab, var(--text) 8%, transparent);
    }
    .suggestion-item:last-child {
      border-bottom: none;
    }
    .suggestion-item:hover {
      background: color-mix(in oklab, var(--text) 8%, transparent);
    }

    a:hover, a:focus-visible {
      text-decoration: underline;
      text-underline-offset: 2px;
    }
    :focus-visible {
      outline: 2px solid color-mix(in oklab, var(--brand) 70%, var(--brand-2) 30%);
      outline-offset: 2px;
    }

    @media (prefers-contrast: more) {
      .lead.accent {
        color: var(--text);
        -webkit-text-fill-color: var(--text);
        background: none;
      }
    }
    @media (forced-colors: active) {
      .lead.accent {
        color: CanvasText;
        background: none;
      }
    }

    @media (max-width: 900px) {
      .hero-inner {
        grid-template-columns: 1fr;
      }
      .skills .skill {
        grid-column: span 12;
      }
      .avatar {
        width: 140px;
      }
      #contact .grid {
        grid-template-columns: 1fr !important;
      }
    }

    @media (prefers-reduced-motion: reduce) {
      * {
        animation-duration: 0.001ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.001ms !important;
      }
      html {
        scroll-behavior: auto;
      }
    }

    @media print {
      header, .hero-cta a[href*="contact"], .btn.primary {
        display: none !important;
      }
      body {
        background: #fff;
      }
      .card, .hero-card {
        break-inside: avoid;
      }
    }
  /* Fallback pro modální kalendář */
  .modalopen { display: grid !important; }
  
  /* Fallback pro modální kalendář */
  .modalopen { display: grid !important; }

  /* Silný override pro otevřený modal */
  .modal.modalopen {
    display: grid !important;
    visibility: visible !important;
    opacity: 1 !important;
    pointer-events: auto !important;
  }

  /* Silný override pro otevřený modal */
  .modal.modalopen {
    display: grid !important;
    visibility: visible !important;
    opacity: 1 !important;
    pointer-events: auto !important;
  }
  /* Silný override pro otevřený modal */
  .modal.modalopen {
    display: grid !important;
    visibility: visible !important;
    opacity: 1 !important;
    pointer-events: auto !important;
  }

  /* Calendar UX: selected day highlight + strong modal override */
  .cal-day.selected { outline: 2px solid currentColor; border-color: transparent; }
  .modal.modalopen {
    display: grid !important;
    visibility: visible !important;
    opacity: 1 !important;
    pointer-events: auto !important;
  }

  /* === Error UI (global) === */
  .error-box {
    border: 2px solid #ef4444;
    background: color-mix(in oklab, #ef4444 10%, transparent);
    border-radius: 14px;
    padding: 14px;
    box-shadow: 0 6px 14px rgba(239, 68, 68, .15);
  }
  .error-box strong { display:block; margin-bottom: 6px; }
  .error-actions { display:flex; gap:10px; flex-wrap:wrap; margin-top: 8px; }
  .btn-ghost {
    display:inline-flex; align-items:center; gap:8px;
    padding: 10px 12px; border-radius: 12px; text-decoration: none;
    border: 1px solid currentColor; font-weight: 600;
    background: color-mix(in oklab, var(--panel) 92%, transparent);
  }
  .btn-mail { color:#1d4ed8; border-color:#1d4ed8; }
  .btn-tel  { color:#16a34a; border-color:#16a34a; }
  .btn-ghost svg { width:18px; height:18px; display:block; }

  .error-box {
    border: 2px solid #ef4444;
    background: rgba(239, 68, 68, 0.12);
    color: #fca5a5;
    border-radius: 14px;
    padding: 16px;
    box-shadow: 0 6px 14px rgba(239,68,68,.18);
  }
  .error-box h4 { margin: 0 0 6px 0; color: #fecaca; font-size: 1rem; }
  .error-box .muted { color: #fca5a5; }
  .error-actions { display:flex; gap:10px; flex-wrap:wrap; margin-top: 10px; }
  .btn-ghost {
    display:inline-flex; align-items:center; gap:8px;
    padding: 10px 12px; border-radius: 12px; text-decoration: none;
    border: 1px solid currentColor; font-weight: 600;
    background: rgba(255,255,255,0.03);
    transition: transform .05s ease, background .15s ease;
  }
  .btn-ghost:hover { transform: translateY(-1px); background: rgba(255,255,255,0.06); }
  .btn-mail { color:#93c5fd; border-color:#93c5fd; }
  .btn-tel  { color:#86efac; border-color:#86efac; }
  .btn-ghost svg { width:18px; height:18px; display:block; }
  .error-contacts { margin-top: 8px; font-family: ui-monospace, SFMono-Regular, Menlo, monospace; }
  .error-contacts a { color:#fff; text-decoration: underline dotted; }

  /* date-inline-hint */
  .input-warn{outline:2px solid #eab308; box-shadow:0 0 0 4px rgba(234,179,8,.15); border-color:#eab308}
  .field-hint{margin-top:.35rem; font-size:.9rem; line-height:1.25rem; color:#a16207; display:flex; align-items:center; gap:.5rem}
  .field-hint.hidden{display:none}
  .field-hint .dot{width:.5rem; height:.5rem; border-radius:9999px; background:#eab308; display:inline-block}

/* inline hint u pole datumu */
.field-hint{margin-top:.5rem;font-size:.95rem;line-height:1.3;border:1px solid #3b82f6;border-radius:.75rem;padding:.6rem .75rem;background:color-mix(in oklab,#3b82f6 12%,transparent);box-shadow:0 6px 14px rgba(59,130,246,.15)}
.field-hint.hidden{display:none}
.field-hint strong{font-weight:600}
.field-hint .mini{opacity:.8;font-size:.9em}

/* === Calendar accessibility & contrast === */
.cal-nav{display:flex;gap:.5rem;align-items:center}
.cal-nav button{display:inline-flex;align-items:center;justify-content:center;width:36px;height:36px;border-radius:10px;border:1px solid #475569;background:#111827}
.cal-nav button:hover{filter:brightness(1.2)}
.cal-nav svg{width:18px;height:18px;stroke:#e5e7eb}
.cal-actions{display:flex;gap:.5rem;justify-content:flex-start;padding-top:.5rem}
.btn-cal{display:inline-flex;align-items:center;gap:.4rem;padding:.55rem .8rem;border-radius:.7rem;border:1px solid #4b5563;background:#0f172a;color:#e5e7eb;font-weight:600}
.btn-cal.primary{border-color:#6366f1;background:linear-gradient(135deg,#4f46e5,#06b6d4)}
.btn-cal:disabled{opacity:.5;pointer-events:none}
.cal-day[aria-selected=true]{outline:2px solid #6366f1;outline-offset:2px;border-radius:.5rem}

/* === Calendar spacing & actions === */
.cal-actions{display:flex;gap:.8rem;flex-wrap:wrap;justify-content:flex-end;padding:.9rem 1rem .7rem}
.btn-cal{display:inline-flex;align-items:center;gap:.5rem;padding:.65rem 1rem;border-radius:.8rem;border:1px solid #4b5563;background:#0f172a;color:#e5e7eb;font-weight:600}
.btn-cal.primary{border-color:#6366f1;background:linear-gradient(135deg,#4f46e5,#06b6d4)}
.cal-nav{display:flex;gap:.6rem;align-items:center}
.cal-nav button{display:inline-flex;align-items:center;justify-content:center;width:40px;height:40px;border-radius:12px;border:1px solid #475569;background:#111827}
.cal-nav svg{width:18px;height:18px;stroke:#e5e7eb}
.cal-day[aria-selected="true"]{outline:2px solid #6366f1;outline-offset:2px;border-radius:.5rem}

/* === Calendar UX patch === */
.cal-footer{display:flex;justify-content:space-between;align-items:center;gap:.75rem;padding:.9rem 1rem .8rem;border-top:1px solid #1f2937}
.cal-actions-left,.cal-actions-right{display:flex;gap:.6rem;flex-wrap:wrap}
.btn-cal{display:inline-flex;align-items:center;gap:.5rem;padding:.6rem 1rem;border-radius:.8rem;border:1px solid #4b5563;background:#0f172a;color:#e5e7eb;font-weight:600}
.btn-cal.primary{border-color:#6366f1;background:linear-gradient(135deg,#4f46e5,#06b6d4)}
.cal-nav{display:flex;gap:.6rem;align-items:center}
.cal-nav button{display:inline-flex;align-items:center;justify-content:center;width:40px;height:40px;border-radius:12px;border:1px solid #475569;background:#111827}
.cal-nav svg{width:18px;height:18px;stroke:#e5e7eb}
.cal-day[aria-selected="true"]{outline:2px solid #6366f1;outline-offset:2px;border-radius:.5rem}

/* === Calendar UX patch (inside modal) === */
#dateModal .cal-footer{display:flex;justify-content:space-between;align-items:center;gap:.75rem;padding:.9rem 1rem;border-top:1px solid #1f2937}
#dateModal .cal-actions-left,#dateModal .cal-actions-right{display:flex;gap:.6rem;flex-wrap:wrap}
#dateModal .btn-cal{display:inline-flex;align-items:center;gap:.5rem;padding:.6rem 1rem;border-radius:.8rem;border:1px solid #4b5563;background:#0f172a;color:#e5e7eb;font-weight:600}
#dateModal .btn-cal.primary{border-color:#6366f1;background:linear-gradient(135deg,#4f46e5,#06b6d4)}
#dateModal .cal-nav{display:flex;gap:.6rem;align-items:center;justify-content:space-between;margin:0 0 .25rem 0}
#dateModal .cal-nav button{display:inline-flex;align-items:center;justify-content:center;width:42px;height:42px;border-radius:12px;border:1px solid #475569;background:#111827}
#dateModal .cal-nav svg{width:18px;height:18px;stroke:#e5e7eb}
#dateModal .cal-day[aria-selected="true"], #dateModal .day--selected{outline:2px solid #6366f1;outline-offset:2px;border-radius:.5rem}
</style>
  <link rel="stylesheet" href="burger-hotfix.css">

  <style id="mobile-menu-styles">
  /* === Hamburger + mobilní menu === */
  .burger-btn {
    display: none;
    align-items: center;
    justify-content: center;
    width: 42px;
    height: 42px;
    border-radius: 12px;
    border: 1px solid color-mix(in oklab, var(--text) 14%, transparent);
    background: color-mix(in oklab, var(--panel) 92%, transparent);
    color: var(--text);
    font-size: 20px;
    cursor: pointer;
  }
  .burger-btn:hover, .burger-btn:focus-visible { box-shadow: var(--ring); border-color: transparent; }

  /* panel se adaptuje na světlý/tmavý režim přes CSS custom properties už v souboru */
  .menu-drawer {
    position: fixed;
    top: 64px;           /* výška headeru */
    left: 0;
    right: 0;
    z-index: 60;
    padding: 10px 16px 16px;
    background: color-mix(in oklab, var(--panel) 96%, transparent);
    border-bottom: 1px solid color-mix(in oklab, var(--text) 14%, transparent);
    box-shadow: 0 14px 30px rgba(0,0,0,.28);
    backdrop-filter: saturate(140%) blur(8px);
    animation: menudrop .18s cubic-bezier(.2,.7,.2,1);
  }
  @keyframes menudrop {
    from { opacity: 0; transform: translateY(-6px); }
    to   { opacity: 1; transform: translateY(0); }
  }
  .menu-drawer nav ul {
    list-style: none; margin: 0; padding: 0;
    display: grid; gap: 8px;
  }
  .menu-drawer a {
    display: block;
    padding: 12px 14px;
    border-radius: 12px;
    background: color-mix(in oklab, var(--panel) 92%, transparent);
    border: 1px solid color-mix(in oklab, var(--text) 10%, transparent);
    color: var(--text);
    font-weight: 600;
    text-decoration: none;
  }
  .menu-drawer a:hover, .menu-drawer a:focus-visible {
    box-shadow: var(--ring); border-color: transparent; text-decoration: none;
  }

  /* Rozvržení na mobilech: zobraz hamburger, skryj desktop menu */
  @media (max-width: 900px) {
    .burger-btn { display: inline-flex; }
    .nav-desktop { display: none; }
    .nav { gap: 10px; }
  }

  /* Na desktopu je mobilní zásuvka vždy skrytá */
  @media (min-width: 901px) {
    .menu-drawer { display: none !important; }
  }
  </style>

</head>
<body>
  <header>
  <div class="container">
    <nav class="nav">
      <!-- hamburger vlevo -->
      <button id="burger" class="burger-btn" aria-label="Otevřít menu" aria-expanded="false" aria-controls="mobileMenu">
        ☰
      </button>

      <a class="brand" href="#top" aria-label="Domů">
        <span class="logo">MH</span>
        <span>Martin Holý</span>
      </a>

      <!-- původní desktopová navigace (zůstává pro ≥900px) -->
      <nav aria-label="Hlavní navigace" class="nav-desktop">
        <ul>
          <li><a href="#about">O mně</a></li>
          <li><a href="#experience">Zkušenosti</a></li>
          <li><a href="#projects">Projekty</a></li>
          <li><a href="#skills">Dovednosti</a></li>
          <li><a href="#contact">Kontakt</a></li>
        </ul>
      </nav>

      <div class="actions">
        <a class="btn primary" href="#contact">Domluvit schůzku</a>
      </div>
    </nav>
  </div>

  <!-- mobilní menu panel (schované) -->
  <div id="mobileMenu" class="menu-drawer" hidden>
    <nav aria-label="Mobilní menu">
      <ul>
        <li><a href="#about">O mně</a></li>
        <li><a href="#experience">Zkušenosti</a></li>
        <li><a href="#projects">Projekty</a></li>
        <li><a href="#skills">Dovednosti</a></li>
        <li><a href="#contact">Kontakt</a></li>
      </ul>
    </nav>
  </div>
</header>

  <main id="top">
    <section class="hero">
      <div class="container hero-inner">
        <div>
          <div class="kicker"><span class="gradtext">Release orchestration · Internal systems · Automation · Processes</span></div>
          <h1>Zlepšuji interní systémy a procesy a pomáhám, aby releasy byly připravené, koordinované a auditovatelné.</h1>
          <div class="h1-underline" aria-hidden="true"></div>
          <p class="lead accent">17+ let v IT. Interní systémy a procesy, automatizace a orchestrace – zkušenost i s releasy v bankovním prostředí (CAB, řízení změn a auditovatelné releasy).</p>
          <ul class="muted" style="margin:0 0 14px 18px">
            <li>Interní systémy Jira/Notion, Backstage, n8n – standardizace · automatizace</li>
            <li>Leadership procesy – vedení 6 lidí, mapování a zjednodušování postupů</li>
            <li>Orchestrace releasů TRAIN → PREPROD → PROD – go/no‑go · rollback · readiness</li>
            <li>Koordinace kapacit a komunikace napříč týmy</li>
          </ul>
          <div class="hero-cta">
            <a class="btn primary" href="#projects">Moje práce</a>
            <a class="btn" href="MartinHoly_ReleaseOrchestrationandSystems.pdf" download>Stáhnout CV (PDF)</a>
          </div>
        </div>
        <div class="hero-aside">
          <figure class="avatar" aria-label="Profilová fotografie – místo pro budoucí portrét">
            <div style="width:100%;height:100%;display:grid;place-items:center;font-weight:800;letter-spacing:.5px;background:linear-gradient(135deg,var(--brand),var(--brand-2));color:#fff">MH</div>
          </figure>
          <div class="hero-card">
            <div class="row">
              <span class="badge">Plný úvazek</span>
              <span class="badge">Praha/Remote</span>
              <span class="badge">Orchestrace · procesy</span>
            </div>
            <p class="muted" style="margin:4px 0 0">Hledám roli se zaměřením na orchestraci releasů a automatizaci procesů – prioritu dávám koordinaci a zlepšování procesů před detailním kódováním.</p>
          </div>
        </div>
      </div>
    </section>

    <section id="about">
      <div class="container">
        <h2 class="section-title">O mně</h2>
        <div class="cards">
          <div class="card">
            <h3>Co přináším</h3>
            <p>Systematický přístup k orchestraci a nasazování. Umím připravit postupy, sladit očekávání a doručit nasazení bez překvapení – s důrazem na kvalitu a dohledatelnost. Současně se zaměřuji na interní systémy Jira/Notion, Backstage, n8n – sjednocení postupů, auditovatelnost a automatizace.</p>
          </div>
          <div class="card">
            <h3>Leadership</h3>
            <p><strong>Hands‑on vedení</strong> 6 techniků (junior → senior) – nastavování rituálů a priorit, mentoring, koordinace práce · incident · change management.</p>
          </div>
          <div class="card">
            <h3>Stack domény</h3>
            <p>Kubernetes, Istio, Docker/Swarm, CI/CD GitHub Actions, IaC Ansible · AWS CDK, observabilita Prometheus, AWS CloudWatch, n8n. Domény: deployment platformy, provoz, procesní automatizace.</p>
          </div>
          <div class="card">
            <h3>Nástroje spolupráce</h3>
            <p><strong>Organizace:</strong> Jira, Confluence, Notion<br><strong>Komunikace:</strong> Slack, MS Teams<br><strong>Repozitáře:</strong> GitHub (vlastním organizaci), Bitbucket (uživatelská role)<br><strong>MS Office:</strong> Excel – plánování a reporting releasů</p>
          </div>
          <div class="card">
            <h3>Spolupráce · ceremonie</h3>
            <p>Scrum of Scrums, ranní standupy v Alma Career, demo se stakeholdery – úzká spolupráce s vývojem, provozem, QA a architekturou.</p>
          </div>
          <div class="card">
            <h3>Release highlights – zkušenosti</h3>
            <ul>
              <li>Zkušenost s podílením se na koordinaci releasů – <strong>alokace kapacit</strong> a nasazování <strong>TRAIN → PREPROD → PROD</strong>.</li>
              <li><strong>CAB</strong> – zkušenost s účastí a hlasováním (schválení/zamítnutí (approve/decline)), technický kontext, rizika a připravenost releasu.</li>
              <li>Příprava nasazení – datové změny, <strong>Oracle WebLogic</strong>, <strong>PL/SQL</strong>, <strong>MSI</strong> deployment.</li>
              <li>post‑release podpora (aftercare) – monitoring, incidenty, <strong>smoke testy</strong>, rollback podle plánu.</li>
              <li>Zvyklý na mimo servisní okna a krátké odstávky s jasnou komunikací.</li>
            </ul>
          </div>
          <div class="card">
            <h3>CAB (Change Advisory Board)</h3>
            <p>Mám zkušenost s účastí a hlasováním v CAB – schvaloval/zamítal jsem požadované změny, poskytoval technický kontext a vyhodnocoval rizika a připravenost releasu.</p>
          </div>
          <div class="card">
            <h3>Bankovní prostředí</h3>
            <p>Zkušenost s požadavky na stabilitu, auditovatelnost nasazení a provozní disciplínu.</p>
          </div>
          <div class="card">
            <h3>Certifikace</h3>
            <ul>
              <li><strong>ISTQB Foundation</strong> (2017)</li>
              <li><strong>ITIL v3 Foundation</strong> (2017)</li>
            </ul>
          </div>
          <div class="card">
            <h3>Jazyky</h3>
            <ul>
              <li>Čeština - rodilý mluvčí</li>
              <li>Angličtina - B2</li>
              <li>Němčina - A2</li>
            </ul>
          </div>
          <div class="card">
            <h3>Reference · na vyžádání</h3>
            <p class="muted">Kontakty poskytnu po domluvě.</p>
          </div>
        </div>
      </div>
    </section>

    <section id="experience">
      <div class="container">
        <h2 class="section-title">Zkušenosti</h2>
        <p class="section-sub">17+ let v IT, postup od podpory po vedení týmů a budování platforem.</p>
        <div class="timeline" aria-label="Kariérní timeline">
          <article class="step">
            <h4>Automation Engineer · Alma Career Czechia s.r.o. (dříve LMC)</h4>
            <div class="row muted"><span>09/2018 – současnost</span><span>Produktová/platformní role</span></div>
            <ul>
              <li>Navrhl a provozoval jsem deployment platformu – selfservice, jednotné pipelines.</li>
              <li>Zavedl jsem Kubernetes · Istio, standardizoval deployment a traffic management.</li>
              <li>Zajišťoval jsem plynulý průběh nasazování na <strong>non‑prod (DEV/DEVEL)</strong> i <strong>PROD</strong> prostředí.</li>
              <li>V <strong>n8n</strong> jsem implementoval workflowy pro <strong>onboarding/offboarding</strong> a <strong>reporting využití GitHub Copilota</strong> – podklady pro plánování rozpočtu/licencí.</li>
              <li>Adopce AI/LLM – využil jsem <strong>Claude Sonnet</strong> pro pair‑coding a dokumentaci v <strong>Backstage</strong> – pomohlo mi to při psaní <strong>AWS CDK</strong> (IaC pro infrastrukturu v AWS) a při přípravě podkladů k releasu.</li>
              <li>Byl jsem součástí týmu <strong>SW architektů</strong>.</li>
              <li>Účastnil jsem se ranních standupech – úzce jsem komunikoval s <strong>vývojem, provozem, testery a architekty</strong>.</li>
            </ul>
          </article>
          <article class="step">
            <h4>DevOps Team Lead · Home Credit International a.s.</h4>
            <div class="row muted"><span>2017 – 06/2018</span><span>Vedoucí týmu DevOps</span></div>
            <ul>
              <li>Staral jsem se o prostředí <strong>DEV</strong> a <strong>UAT</strong>.</li>
              <li>Budování infrastruktury pro expanzi Air Bank v zahraničí.</li>
              <li>Provoz a automatizace – VM, Docker, Docker Swarm, Kubernetes · Istio.</li>
              <li>Nastavení CI/CD, monitoring a incident management napříč týmy.</li>
              <li>Nastavil a hlídal jsem integrační testy v <strong>Jenkins</strong> a <strong>Cucumber</strong> – reportoval jsem bugy vývojům a ladil infrastrukturu i deployment plány (Docker Swarm · Kubernetes).</li>
              <li>Účastnil jsem se dem a operativně pomáhal řešit problémy během nich.</li>
              <li>Účast na <strong>Scrum of Scrums</strong> a <strong>ranních standupechech</strong> – úzká spolupráce s vývojem, provozem, testery a architekty.</li>
            </ul>
          </article>
          <article class="step">
            <h4>Team Lead Application Support · Home Credit International a.s.</h4>
            <div class="row muted"><span>2013 – 2017</span><span>6 lidí (junior → senior)</span></div>
            <ul>
              <li>Vedl jsem tým aplikačních specialistů, nastavil procesy a metriky SLA/OLA, reporting.</li>
              <li>Řídil jsem plnění service request a katalogizoval část SR pro zrychlené odbavení.</li>
              <li>Přebral a rozšířil jsem automatizaci nasazování na <strong>TRAIN · UAT/školení</strong> prostředí – část automatů jsem doprogramoval.</li>
              <li>Podílel jsem se na koordinaci nasazení – alokoval jsem kapacity a se svým týmem jsme nasazovali na <strong>PREPROD</strong> (ověření postupu) a následně na <strong>PROD</strong> v mimo servisní okna s go/no‑go rozhodnutím.</li>
            </ul>
          </article>
          <article class="step">
            <h4>Senior Application Support · Home Credit International a.s.</h4>
            <div class="row muted"><span>2012 – 2013</span><span>Provoz · incidenty</span></div>
            <ul>
              <li>Kromě incident managementu jsem plnil service requesty a ze vzorů vytvářel <strong>RfC</strong> pro vývoj.</li>
              <li>Prováděl jsem manuální <strong>smoke testy</strong> po nasazeních.</li>
              <li>Nasazoval jsem <strong>datové změny</strong> i celé releasy serverových aplikací na <strong>Oracle WebLogic</strong>.</li>
              <li>Část aplikační logiky jsem nasazoval jako <strong>Oracle DB PL/SQL</strong> procedury v téže RDBMS.</li>
              <li>Distribuoval jsem MSI balíky tenkých klientů na Windows stanicích.</li>
              <li>Prováděl jsem nasazení na <strong>TRAIN</strong> · UAT/školení a <strong>PREPROD</strong> – a po úspěchu následoval <strong>PROD</strong> release s go/no‑go od zákazníka i release managera.</li>
            </ul>
          </article>
          <article class="step">
            <h4>IBM – dohled a správa server/infrastruktury pro ABB (USA/CA · APAC)</h4>
            <div class="row muted"><span>2010 – 2012</span><span>Monitoring · správa</span></div>
            <ul>
              <li>Provozní dohled, správa IBM serverů a infrastruktury pro enterprise prostředí.</li>
            </ul>
          </article>
          <article class="step">
            <h4>Technical Support · AVG</h4>
            <div class="row muted"><span>2008 – 2010</span><span>Začátky v IT</span></div>
            <ul>
              <li>První zkušenosti s komunikací se zákazníky a řešením problémů.</li>
            </ul>
          </article>
        </div>
      </div>
    </section>

    <section id="projects">
      <div class="container">
        <h2 class="section-title">Projekty</h2>
        <p class="section-sub">Ukázky práce zaměřené na automatizaci, orchestraci a deployment.</p>
        <div class="cards">
          <article class="card">
            <div class="thumb thumb--cicd" aria-hidden="true">CI/CD · Deployment platforma</div>
            <h3>Deployment platforma – Alma Career</h3>
            <p>Navrhl a provozoval jsem selfservice nasazování se standardizovanými pipelines, auditovatelnost a rollbacky. Zrychlil jsem lead‑time a snížil chybovost releasů.</p>
            <div class="badges">
              <span class="badge">CI/CD</span>
              <span class="badge">Audit trail</span>
              <span class="badge">Rollback</span>
            </div>
          </article>
          <article class="card">
            <div class="thumb thumb--k8s" aria-hidden="true">Kubernetes · Istio</div>
            <h3>Kubernetes · Istio rollout</h3>
            <p>Migroval jsem služby na K8s, nastavil traffic shaping přes Istio a zavedl canary/blue‑green strategie i standardizovanou observabilitu.</p>
            <div class="badges">
              <span class="badge">Kubernetes</span>
              <span class="badge">Istio</span>
              <span class="badge">Canary</span>
              <span class="badge">Blue‑green</span>
            </div>
          </article>
          <article class="card">
            <div class="thumb thumb--n8n" aria-hidden="true">n8n · Onboarding/Offboarding</div>
            <h3>n8n workflow – onboarding/offboarding · Copilot reporting</h3>
            <p>V n8n jsem navrhl a zprovoznil workflowy pro onboarding a offboarding uživatelů a automatizoval <strong>reporting využití GitHub Copilota</strong> – přehledy pro vedení a rozpočtování/licencování.</p>
            <div class="badges">
              <span class="badge">n8n</span>
              <span class="badge">Onboarding/Offboarding</span>
              <span class="badge">Reporting</span>
            </div>
          </article>
          <article class="card">
            <div class="thumb thumb--backstage" aria-hidden="true">Backstage · LLM</div>
            <h3>LLM pro dokumentaci v Backstage</h3>
            <p>Využil jsem Claude Sonnet pro pair‑coding a generování dokumentace v Backstage service katalogu – pomohl mi také při psaní <strong>AWS CDK</strong> (IaC pro infrastrukturu v AWS) a při přípravě podkladů k releasům (release notes, shrnutí změn).</p>
            <div class="badges">
              <span class="badge">Claude Sonnet</span>
              <span class="badge">Backstage</span>
              <span class="badge">AWS CDK</span>
              <span class="badge">Dokumentace</span>
            </div>
          </article>
        </div>
      </div>
    </section>

    <section id="skills">
      <div class="container">
        <h2 class="section-title">Dovednosti</h2>
        <p class="section-sub">Release/Change komunikace + potřebný technický základ – orientační úrovně.</p>
        <div class="skills">
          <div class="skill"><span>Release planning · change kalendář</span><div class="bar"><i style="--value: 88%"></i></div></div>
          <div class="skill"><span>CAB účast · schvalování (schválení/zamítnutí (approve/decline))</span><div class="bar"><i style="--value: 86%"></i></div></div>
          <div class="skill"><span>Go/No‑Go · rollback · readiness</span><div class="bar"><i style="--value: 84%"></i></div></div>
          <div class="skill"><span>UAT/Training · PREPROD připravenost</span><div class="bar"><i style="--value: 82%"></i></div></div>
          <div class="skill"><span>Komunikace · stakeholder management</span><div class="bar"><i style="--value: 88%"></i></div></div>
          <div class="skill"><span>Incident/Change (ITIL) · aftercare</span><div class="bar"><i style="--value: 82%"></i></div></div>
          <div class="skill"><span>Dokumentace – Notion · Backstage</span><div class="bar"><i style="--value: 80%"></i></div></div>
          <div class="skill"><span>Jira – workflow · reporting</span><div class="bar"><i style="--value: 86%"></i></div></div>
          <div class="skill"><span>CI/CD – GitHub Actions</span><div class="bar"><i style="--value: 86%"></i></div></div>
          <div class="skill"><span>Jenkins · Cucumber (integrační testy)</span><div class="bar"><i style="--value: 72%"></i></div></div>
          <div class="skill"><span>Kubernetes · Istio</span><div class="bar"><i style="--value: 78%"></i></div></div>
          <div class="skill"><span>Docker · Swarm</span><div class="bar"><i style="--value: 76%"></i></div></div>
          <div class="skill"><span>Ansible roles</span><div class="bar"><i style="--value: 82%"></i></div></div>
          <div class="skill"><span>AWS CDK (IaC)</span><div class="bar"><i style="--value: 60%"></i></div></div>
          <div class="skill"><span>Observabilita – AWS CloudWatch · Prometheus</span><div class="bar"><i style="--value: 80%"></i></div></div>
        </div>
      </div>
    </section>

    <section id="contact">
      <div class="container">
        <h2 class="section-title">Kontakt</h2>
        <p id="contactSub" class="section-sub">Vyberte remote/onsite a volný slot – zbytek zařídí automatizace.</p>
        <form id="contactForm">
          <div class="grid" style="grid-template-columns: 1fr 1fr; gap: 12px">
            <div>
              <label for="name">Jméno</label>
              <input id="name" name="name" autocomplete="name" required>
            </div>
            <div>
              <label for="email">Email</label>
              <input id="email" name="email" type="email" autocomplete="email" required>
            </div>
          </div>
          <div>
            <label for="phone">Telefonní číslo</label>
            <input id="phone" name="phone" type="tel" autocomplete="tel" required>
          <div>
            <label for="company">Název firmy</label>
            <input id="company" name="company" type="text" autocomplete="organization" required>
          </div>
          </div>
          <div class="grid" style="grid-template-columns: 1fr 1fr; gap: 12px">
            <div>
              <label for="mode">Forma setkání</label>
              <select id="mode" name="mode" required>
                <option value="remote" selected>Remote (Google Meet)</option>
                <option value="onsite">Onsite (Praha)</option>
              </select>
            </div>
            <div>
              <label for="date">Preferované datum</label>
              <input id="date" name="date" type="text" inputmode="none" placeholder="rrrr-mm-dd" autocomplete="off" required readonly>
            </div>
          </div>
          <div id="onsiteGroup" class="hidden" style="position: relative">
            <label for="location">Místo schůzky</label>
            <input id="location" name="location" placeholder="Začněte psát adresu..." autocomplete="off">
            <div id="locationSuggestions" class="suggestions hidden"></div>
          </div>
          <div>
            <label>Volné časové sloty</label>
            <div id="slots" class="slots" role="listbox" aria-label="Dostupné termíny"></div>
            <input type="hidden" id="slot" name="slot" required>
          
          <div id="slotHelp" class="muted" aria-live="polite"></div></div>
          <div>
            <label for="message">Zpráva</label>
            <textarea id="message" name="message" placeholder="Krátký kontext, scope a očekávání" required></textarea>
          </div>
          <input type="text" id="homepage" name="homepage" class="hidden" tabindex="-1" autocomplete="off">
          <div class="row">
            <button class="btn primary" type="submit">Odeslat</button>
            <span id="formStatus" class="muted" role="status" aria-live="polite"></span>
          </div>
        </form>
        <div id="formThanks" class="notice notice--success hidden" role="status" aria-live="polite">
          <strong>Děkuji!</strong> Zpráva byla odeslána. Potvrzení s detaily termínu dorazí emailem do 5 minut.
        </div>
        <div id="formError" class="notice notice--error hidden" role="alert" aria-live="assertive">
          <strong>Chyba!</strong> Nepodařilo se odeslat zprávu. Zkuste to prosím znovu nebo mě kontaktujte přímo emailem.
        </div>
      </div>
    </section>
  </main>

  <footer>
    <div class="container row" style="justify-content: space-between">
      <div>© <span id="year"></span> Martin Holý · <a href="#top">Zpět nahoru ↑</a></div>
    </div>
  </footer>

  <div id="dateModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="calTitle">
    <div class="dialog">
      <div class="cal-head">
        <button class="iconbtn" type="button" id="calPrev" aria-label="Předchozí měsíc">◀</button>
        <div id="calTitle" class="cal-title">Výběr data</div>
        <button class="iconbtn" type="button" id="calNext" aria-label="Další měsíc">▶</button>
      </div>
      <div class="cal-grid" id="calGridDOW" aria-hidden="true"></div>
      <div class="cal-grid" id="calGrid"></div>
      <div class="cal-actions">
        <button class="btn" type="button" id="calCancel">Zrušit</button>
        <button class="btn primary" type="button" id="calToday">Dnes</button>
      </div>
    </div>
  </div>

  <script>
    const revealEls = document.querySelectorAll('.card, .step, .skill');
    const reduce = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
    if (reduce) {
      revealEls.forEach(el => el.style.opacity = 1);
    } else {
      const io = new IntersectionObserver(entries => {
        for (const e of entries) {
          if (e.isIntersecting) {
            e.target.animate(
              [
                { opacity: 0, transform: 'translateY(8px)' },
                { opacity: 1, transform: 'translateY(0)' }
              ],
              {
                duration: 420,
                easing: 'cubic-bezier(.2,.7,.2,1)',
                fill: 'forwards'
              }
            );
            io.unobserve(e.target);
          }
        }
      }, { threshold: 0.08 });
      revealEls.forEach(el => io.observe(el));
    }

    const N8N_WEBHOOK_URL = 'https://n8n.replikanti.xyz/webhook/2dd3071a-0719-40e9-99ad-e246ce174fa1';

    const dateField = document.getElementById('date');
    const modal = document.getElementById('dateModal');
    const calTitle = document.getElementById('calTitle');
    const calGrid = document.getElementById('calGrid');
    const calGridDOW = document.getElementById('calGridDOW');
    const calPrev = document.getElementById('calPrev');
    const calNext = document.getElementById('calNext');
    const calToday = document.getElementById('calToday');
    const calCancel = document.getElementById('calCancel');

    const DOW = ['Po','Út','St','Čt','Pá','So','Ne'];
    function pad(n) { return n.toString().padStart(2,'0'); }
    function fmt(y,m,d) { return `${y}-${pad(m+1)}-${pad(d)}`; }

    let view = (function() {
      const now = new Date();
      return { y: now.getFullYear(), m: now.getMonth() };
    })();

    function renderDOW() {
      calGridDOW.innerHTML = '';
      DOW.forEach(d => {
        const el = document.createElement('div');
        el.className = 'cal-dow';
        el.textContent = d;
        calGridDOW.appendChild(el);
      });
    }

    function renderCal() {
      const first = new Date(view.y, view.m, 1);
      const last = new Date(view.y, view.m + 1, 0);
      calTitle.textContent = first.toLocaleString('cs-CZ', { month: 'long', year: 'numeric' });
      calGrid.innerHTML = '';

      let start = (first.getDay() + 6) % 7;
      for (let i = 0; i < start; i++) {
        const s = document.createElement('div');
        calGrid.appendChild(s);
      }

      for (let d = 1; d <= last.getDate(); d++) {
        const btn = document.createElement('button');
        btn.type = 'button';
        btn.className = 'cal-day';
        btn.textContent = d;
        const iso = fmt(view.y, view.m, d);
        btn.dataset.iso = iso;
        btn.addEventListener('click', () => {
          dateField.value = iso;
          closeCal();
          renderSlots();
        });
        calGrid.appendChild(btn);
      }
    }

    function openCal() {
      modal.setAttribute('open', '');
      renderDOW();
      renderCal();
    }
    function closeCal() {
      modal.removeAttribute('open');
    }

    dateField.addEventListener('focus', openCal);
    dateField.addEventListener('click', openCal);

    calPrev.addEventListener('click', () => {
      if (--view.m < 0) {
        view.m = 11;
        view.y--;
      }
      renderCal();
    });

    calNext.addEventListener('click', () => {
      if (++view.m > 11) {
        view.m = 0;
        view.y++;
      }
      renderCal();
    });

    calToday.addEventListener('click', () => {
      const n = new Date();
      view.y = n.getFullYear();
      view.m = n.getMonth();
      renderCal();
    });

    calCancel.addEventListener('click', closeCal);

    modal.addEventListener('click', (e) => {
      if (e.target === modal) closeCal();
    });

    function generateSlots(dateStr, mode) {
      if (!dateStr) return [];
      const d = new Date(dateStr + 'T00:00:00');
      const day = d.getDay();
      const base = mode === 'onsite' ? ['10:00','11:00','14:00','15:00'] : ['10:00','11:00','13:00','16:00'];
      if (day === 0 || day === 6) return [];
      return base.map(t => ({ label: t, value: `${dateStr} ${t}` }));
    }

    const form = document.getElementById('contactForm');
    const status = document.getElementById('formStatus');
    const slotsEl = document.getElementById('slots');
    const slotInput = document.getElementById('slot');
    const dateInput = document.getElementById('date');
    const modeInput = document.getElementById('mode');
    const onsiteGroup = document.getElementById('onsiteGroup');
    const thanks = document.getElementById('formThanks');

    // Nominatim autocomplete
    const locationInput = document.getElementById('location');
    const suggestionsEl = document.getElementById('locationSuggestions');
    let searchTimeout;

    locationInput?.addEventListener('input', (e) => {
      const query = e.target.value.trim();
      clearTimeout(searchTimeout);
      
      if (query.length < 3) {
        suggestionsEl.classList.add('hidden');
        suggestionsEl.innerHTML = '';
        return;
      }

      searchTimeout = setTimeout(async () => {
        try {
          const response = await fetch(
            `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(query)}&countrycodes=cz&limit=5`,
            {
              headers: {
                'User-Agent': 'MartinHolyPortfolio/1.0'
              }
            }
          );
          const results = await response.json();
          
          if (results.length === 0) {
            suggestionsEl.classList.add('hidden');
            return;
          }

          suggestionsEl.innerHTML = '';
          results.forEach(result => {
            const div = document.createElement('div');
            div.className = 'suggestion-item';
            div.textContent = result.display_name;
            div.addEventListener('click', () => {
              locationInput.value = result.display_name;
              suggestionsEl.classList.add('hidden');
            });
            suggestionsEl.appendChild(div);
          });
          suggestionsEl.classList.remove('hidden');
        } catch (err) {
          console.error('Nominatim error:', err);
        }
      }, 400);
    });

    // Skrytí návrhů při kliknutí mimo
    document.addEventListener('click', (e) => {
      if (!locationInput.contains(e.target) && !suggestionsEl.contains(e.target)) {
        suggestionsEl.classList.add('hidden');
      }
    });

    function renderSlots() {
  const slots = generateSlots(dateInput.value, modeInput.value);
  slotsEl.innerHTML = "";
  slotInput.value = "";
  if (!slots.length) {
    const p = document.createElement("p");
    p.className = "muted";
    p.textContent = "Žádné volné sloty pro zvolené datum.";
    slotsEl.appendChild(p);
    return;
  }
  slots.forEach(s => {
    const btn = document.createElement("button");
    btn.type = "button";
    btn.className = "slot";
    btn.setAttribute("role","option");
    btn.textContent = s.label;
    btn.addEventListener("click", () => {
      slotsEl.querySelectorAll(".slot").forEach(b => b.setAttribute("aria-pressed","false"));
      btn.setAttribute("aria-pressed","true");
      slotInput.value = s.value;
    });
    slotsEl.appendChild(btn);
  });
}

// listenery MUSÍ být mimo funkci

dateInput.addEventListener("change", renderSlots);
modeInput.addEventListener("change", () => {
  const isOnsite = modeInput.value === "onsite";
  onsiteGroup.classList.toggle("hidden", !isOnsite);
  const locationField = document.getElementById("location");
  if (locationField) {
    if (isOnsite) locationField.setAttribute("required", ""); else locationField.removeAttribute("required");
  }
  renderSlots();
});
    function nextBusinessISO() {
      const d = new Date();
      d.setDate(d.getDate() + 1);
      if (d.getDay() === 6) d.setDate(d.getDate() + 2);
      if (d.getDay() === 0) d.setDate(d.getDate() + 1);
      return d.toISOString().slice(0,10);
    }

    function initDate() {
      const iso = nextBusinessISO();
      dateInput.value = iso;
      renderSlots();
      onsiteGroup.classList.toggle('hidden', modeInput.value !== 'onsite');
    }

    form?.addEventListener('submit', async (e) => {
      e.preventDefault();
      status.textContent = 'Odesílám…';

      if (document.getElementById('homepage').value) return;

      // validace formuláře
      const nameField = document.getElementById('name');
      const emailField = document.getElementById('email');
      const dateField = document.getElementById('date');
      const slotField = document.getElementById('slot');
      const messageField = document.getElementById('message');

      if (!nameField.value.trim()) {
        status.textContent = 'Vyplňte prosím jméno.';
        nameField.focus();
        return;
      }

      const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (!emailField.value.trim() || !emailPattern.test(emailField.value.trim())) {
        status.textContent = 'Vyplňte prosím platnou emailovou adresu.';
        emailField.focus();
        return;
      }

      if (!dateField.value) {
        status.textContent = 'Vyberte prosím datum.';
        dateField.focus();
        return;
      }

      if (!slotField.value) {
        status.textContent = 'Vyberte prosím časový slot.';
        return;
      }

      if (!messageField.value.trim()) {
        status.textContent = 'Vyplňte prosím zprávu.';
        messageField.focus();
        return;
      }

      const phoneField = document.getElementById('phone');
      if (!phoneField.value.trim()) {
        status.textContent = 'Vyplňte prosím telefonní číslo.';
        phoneField.focus();
        return;
      }

      const locationField = document.getElementById('location');
      if (modeInput.value === 'onsite' && !locationField.value.trim()) {
        status.textContent = 'Pro on-site schůzku vyplňte prosím místo.';
        locationField.focus();
        return;
      }

      const data = Object.fromEntries(new FormData(form));
      const errorNotice = document.getElementById('formError');
      const contactSub = document.getElementById('contactSub');

      try {
        if (N8N_WEBHOOK_URL) {
          await fetch(N8N_WEBHOOK_URL, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
          });
        } else {
          console.log('Demo data:', data);
        }

        form.classList.add('hidden');
        contactSub.classList.add('hidden');
        thanks.classList.remove('hidden');
        errorNotice.classList.add('hidden');
      } catch (err) {
        console.error(err);
        status.textContent = '';
        errorNotice.classList.remove('hidden');
        thanks.classList.add('hidden');
      }
    });

    document.getElementById('year').textContent = new Date().getFullYear();

    initDate();
  </script>
<script>
document.addEventListener("DOMContentLoaded", function () {
  var dateField = document.getElementById("date");
  var modal = document.getElementById("dateModal");

  // Bezpečné dopřipojení listenerů – jen pokud prvky existují
  if (dateField && modal) {
    dateField.addEventListener("focus", openCalSafe);
    dateField.addEventListener("click", openCalSafe);
    dateField.addEventListener("keydown", function(e){
      if (e.key === "Enter" || e.key === " " || e.code === "Space") { e.preventDefault(); openCalSafe(); }
    });
  }

  // Univerzální otevření modalu pro <div class="modal"> i <dialog>
  function openCalSafe() {
    if (!modal) return;
    try {
      // agresivní zviditelnění (přebije display:none, visibility:hidden, opacity:0, pointer-events:none)
      modal.classList.remove("hidden");
      modal.classList.add("modalopen");
      modal.style.display = "grid";
      modal.style.visibility = "visible";
      modal.style.opacity = "1";
      modal.style.pointerEvents = "auto";
      modal.setAttribute("aria-hidden", "false");

      // pokud máš vlastní funkce kalendáře, bezpečně je zavoláme
      try { if (typeof renderDOW === "function") renderDOW(); } catch(e) {}
      try { if (typeof renderCal === "function") renderCal(); } catch(e) {}

      // podpora <dialog>
      if (modal.tagName && modal.tagName.toLowerCase() === "dialog") {
        modal.setAttribute("open", "");
        if (modal.showModal) { try { modal.showModal(); } catch(e) {} }
      }
    } catch(e) { console.error(e); }
  }
});
</script>
<script>
(function(){
  var dateInput = document.getElementById('date');
  var modal = document.getElementById('dateModal');
  var grid = document.getElementById('calGrid');
  var title = document.getElementById('calTitle');
  var btnToday = document.getElementById('calToday');
  var btnCancel = document.getElementById('calCancel');
  var actions = document.querySelector('#dateModal .cal-actions');

  if (!dateInput || !modal) return;

  // Přidat "Potvrdit", pokud chybí
  var btnConfirm = document.getElementById('calConfirm');
  if (!btnConfirm && actions) {
    btnConfirm = document.createElement('button');
    btnConfirm.id = 'calConfirm';
    btnConfirm.type = 'button';
    btnConfirm.className = 'btn primary';
    btnConfirm.textContent = 'Potvrdit';
    actions.appendChild(btnConfirm);
  }

  // Interní stav vybraného ISO data
  var pickedISO = null;

  // Mapování CZ měsíců pro případ, že nemáme data-atributy
  var czMonths = {
    'leden':1,'únor':2,'březen':3,'duben':4,'květen':5,'červen':6,
    'červenec':7,'srpen':8,'září':9,'říjen':10,'listopad':11,'prosinec':12
  };

  function pad(n){ return String(n).padStart(2,'0'); }

  function deriveISOFromCell(btn){
    // 1) preferuj data-iso, pokud je vygenerované tvou renderCal()
    var iso = btn.getAttribute('data-iso');
    if (iso) return iso;

    // 2) fallback: z calTitle "říjen 2025" a čísla dne odvoď ISO
    if (!title) return null;
    var txt = (title.textContent || title.innerText || '').trim().toLowerCase();
    var m = txt.match(/(leden|únor|březen|duben|květen|červen|červenec|srpen|září|říjen|listopad|prosinec)\s+(\d{4})/i);
    if (!m) return null;
    var month = czMonths[m[1].toLowerCase()];
    var year = parseInt(m[2], 10);
    var day = parseInt(btn.textContent, 10);
    if (!month || !year || !day) return null;
    return year + '-' + pad(month) + '-' + pad(day);
  }

  function highlight(btn){
    if (!grid) return;
    Array.prototype.forEach.call(grid.querySelectorAll('.cal-day.selected'), function(el){
      el.classList.remove('selected');
    });
    btn.classList.add('selected');
  }

  function closeModal(){
    // naše bezpečné uzavření div.modal
    modal.classList.remove('modalopen');
    modal.style.display = '';
    modal.style.visibility = '';
    modal.style.opacity = '';
    modal.style.pointerEvents = '';
    modal.setAttribute('aria-hidden','true');
  }

  // Delegace kliknutí na dny
  if (grid) {
    grid.addEventListener('click', function(e){
      var t = e.target;
      if (!t) return;
      if (!t.classList.contains('cal-day')) return;
      var iso = deriveISOFromCell(t);
      if (!iso) return;
      pickedISO = iso;
      highlight(t);
    });
  }

  // Dnes
  if (btnToday) {
    btnToday.addEventListener('click', function(){
      var today = new Date();
      var iso = today.toISOString().slice(0,10);
      pickedISO = iso;
      // zvýraznit den v mřížce (pokud existuje odpovídající button)
      if (grid) {
        var cand = Array.prototype.find.call(grid.querySelectorAll('.cal-day'), function(b){
          return (b.getAttribute('data-iso') === iso) || (b.textContent.trim() === String(today.getDate()));
        });
        if (cand) highlight(cand);
      }
    });
  }

  // Zrušit
  if (btnCancel) {
    btnCancel.addEventListener('click', function(){
      closeModal();
    });
  }

  // Potvrdit – nastaví <input id="date"> a načte sloty
  if (btnConfirm) {
    btnConfirm.addEventListener('click', function(){
      if (!pickedISO) {
        // pokud uživatel neklikl na den, ale chce potvrdit, zkus použít dnešek
        pickedISO = pickedISO || new Date().toISOString().slice(0,10);
      }
      if (pickedISO) {
        dateInput.value = pickedISO;
        // vyvolej změnu → ať na to reaguje existující logika (renderSlots apod.)
        try { dateInput.dispatchEvent(new Event('change')); } catch(e) {}
      }
      closeModal();
    });
  }

  // Pokud máš "otevírače" (focus/click) jinde, nevadí; tohle je fallback.
  // Když se modal otevře jinde (třeba openCalSafe), počítáme s tím, že renderDOW/renderCal už proběhne.
})();
</script>
<script>
  const SLOT_DURATION_MIN = 60;
  const USER_TZ = Intl.DateTimeFormat().resolvedOptions().timeZone || 'Europe/Prague';
</script>
<script>
(function(){
  function ensureErrorBox(){
    var box = document.getElementById('formError');
    if (!box) {
      var c = document.getElementById('contact') || document.body;
      box = document.createElement('div');
      box.id = 'formError';
      box.className = 'notice notice--error';
      c.appendChild(box);
    }
    return box;
  }
  function esc(s){ return (s||'').replace(/[&<>"']/g, m=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m])); }

  window.hideGlobalError = function(){
    var box = document.getElementById('formError');
    if (box) { box.classList.add('hidden'); box.innerHTML = ''; }
  };

  window.showGlobalError = function(reason){
    var box = ensureErrorBox();
    box.classList.remove('hidden');
    box.innerHTML =
      '<div class="error-box" role="alert" aria-live="assertive">' +
      '  <strong>Oops, něco se nepovedlo.</strong>' +
      (reason ? ('<div class="muted" style="margin:.25rem 0 .5rem 0;">'+ esc(reason) +'</div>') : '') +
      '  <div class="error-actions">' +
      '    <a class="btn-ghost btn-mail" href="mailto:mholy1983@gmail.com">' +
      '      <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M20 4H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2Zm0 4-8 5L4 8V6l8 5 8-5Z"/></svg>' +
      '      Napište mi' +
      '    </a>' +
      '    <a class="btn-ghost btn-tel" href="tel:+420792305456">' +
      '      <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M6.6 10.8a15.1 15.1 0 0 0 6.6 6.6l2.2-2.2a1 1 0 0 1 1-.25 11.6 11.6 0 0 0 3.6.6 1 1 0 0 1 1 1v3.7a1 1 0 0 1-1 1A17.6 17.6 0 0 1 2.5 5a1 1 0 0 1 1-1H7a1 1 0 0 1 1 1 11.6 11.6 0 0 0 .6 3.6 1 1 0 0 1-.25 1Z"/></svg>' +
      '      Zavolejte mi' +
      '    </a>' +
      '  </div>' +
      '</div>';
    try { box.scrollIntoView({behavior:'smooth', block:'center'}); } catch(e){}
  };
})();
</script>
<script>
(function(){
  // Přímé uchopení prvků (používáme existující ID)
  var dateInput = document.getElementById('date');
  var modeInput = document.getElementById('mode');
  var slotsEl   = document.getElementById('slots');
  var slotInput = document.getElementById('slot');
  var slotHelp  = document.getElementById('slotHelp');

  if (!dateInput || !modeInput || !slotsEl || !slotInput) return;

  // Přepíšeme existující renderSlots() moderní verzí s GET → n8n
  window.renderSlots = async function renderSlots() {
  const slotHelp = document.getElementById('slotHelp');
  if (slotHelp) slotHelp.textContent = 'Načítám volné časy…';
  slotsEl.innerHTML = '';
  slotInput.value = '';

  try {
    const { requestedDate, resolvedDate, slots } =
      await fetchSlots(dateInput.value, modeInput.value);

    // posun na nejbližší volný den + info pro uživatele
    if (resolvedDate && resolvedDate !== dateInput.value) {
      dateInput.value = resolvedDate;
      if (typeof view !== 'undefined') {
        try {
          const d0 = new Date(resolvedDate);
          view.y = d0.getFullYear();
          view.m = d0.getMonth();
          if (typeof renderCal === 'function') renderCal();
        } catch(e){}
      }
      if (slotHelp) {
        const d = new Date(resolvedDate);
        slotHelp.textContent =
          `Zvolený den není k dispozici. Nabízím nejbližší volné termíny pro ${d.toLocaleDateString('cs-CZ')}.`;
      }
    } else {
      if (slotHelp) slotHelp.textContent = '';
    }

    if (!slots.length) {
      const p = document.createElement('p');
      p.className = 'muted';
      p.textContent = 'Žádné volné sloty pro zvolené datum.';
      slotsEl.appendChild(p);
      return;
    }

    slots.forEach(s => {
      const btn = document.createElement('button');
      btn.type = 'button';
      btn.className = 'slot';
      btn.setAttribute('role','option');
      btn.setAttribute('aria-pressed','false');

      const label = s.label || s.start || s.time || '—';
      const value = s.value || s.start || s.time || '';

      btn.textContent = label;
      btn.addEventListener('click', () => {
        [...slotsEl.querySelectorAll('.slot')].forEach(b => b.setAttribute('aria-pressed','false'));
        btn.setAttribute('aria-pressed','true');
        slotInput.value = value;
      });

      slotsEl.appendChild(btn);
    });
  } catch (err) {
    console.error(err);
    if (slotHelp) slotHelp.textContent = '';
    const p = document.createElement('p');
    p.className = 'muted';
    p.textContent = 'Nepodařilo se načíst sloty.';
    slotsEl.appendChild(p);
    if (typeof showGlobalError === 'function') showGlobalError('Načítání slotů z n8n selhalo.');
  }
})();
</script>
<script id="slots-config">
  window.SLOTS_API = 'https://n8n.replikanti.xyz/webhook/8b1f7b37-e65d-4546-a84a-2c51e7e8cbf5';
  window.SLOT_DURATION_MIN = 30;
  window.USER_TZ = (Intl.DateTimeFormat().resolvedOptions().timeZone || 'Europe/Prague');
</script>

<script>
(function(){
  function ensureErrorBox(){
    var box = document.getElementById('formError');
    if (!box) {
      var c = document.getElementById('contact') || document.body;
      box = document.createElement('div');
      box.id = 'formError';
      box.className = 'notice notice--error';
      c.appendChild(box);
    }
    return box;
  }
  function esc(s){ return (s||'').replace(/[&<>"']/g, m=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m])); }

  window.hideGlobalError = function(){
    var box = document.getElementById('formError');
    if (box) { box.classList.add('hidden'); box.innerHTML = ''; }
  };

  window.showGlobalError = function(reason){
    var box = ensureErrorBox();
    box.classList.remove('hidden');
    box.innerHTML =
      '<div class="error-box" role="alert" aria-live="assertive">' +
      '  <h4>Oops, něco se nepovedlo.</h4>' +
      (reason ? ('<div class="muted">'+ esc(reason) +'</div>') : '') +
      '  <div class="error-contacts">Email: <a href="mailto:mholy1983@gmail.com">mholy1983@gmail.com</a> · Telefon: <a href="tel:+420792305456">+420&nbsp;792&nbsp;305&nbsp;456</a></div>' +
      '  <div class="error-actions">' +
      '    <a class="btn-ghost btn-mail" href="mailto:mholy1983@gmail.com">' +
      '      <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M20 4H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2Zm0 4-8 5L4 8V6l8 5 8-5Z"/></svg>' +
      '      Napište mi' +
      '    </a>' +
      '    <a class="btn-ghost btn-tel" href="tel:+420792305456">' +
      '      <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M6.6 10.8a15.1 15.1 0 0 0 6.6 6.6l2.2-2.2a1 1 0 0 1 1-.25 11.6 11.6 0 0 0 3.6.6 1 1 0 0 1 1 1v3.7a1 1 0 0 1-1 1A17.6 17.6 0 0 1 2.5 5a1 1 0 0 1 1-1H7a1 1 0 0 1 1 1 11.6 11.6 0 0 0 .6 3.6 1 1 0 0 1-.25 1Z"/></svg>' +
      '      Zavolejte mi' +
      '    </a>' +
      '  </div>' +
      '</div>';
    try { box.scrollIntoView({behavior:'smooth', block:'center'}); } catch(e){}
  };
})();
</script>

<script>
function formatCzDate(iso) {
  try {
    const d = new Date(iso + 'T00:00:00');
    return d.toLocaleDateString('cs-CZ', { weekday: 'short', day: '2-digit', month: '2-digit', year: 'numeric' });
  } catch(e) { return iso; }
}
function setDateISO(iso) {
  try {
    var dateInput = document.getElementById('date');
    if (dateInput) dateInput.value = iso;
    if (typeof view !== 'undefined') {
      const d = new Date(iso + 'T00:00:00');
      view.y = d.getFullYear();
      view.m = d.getMonth();
      if (typeof renderCal === 'function') renderCal();
    }
  } catch(e){}
}
</script>

<script>/* slots-init */
(function(){
  function onReady(fn){ if(document.readyState!=='loading') fn(); else document.addEventListener('DOMContentLoaded', fn); }
  onReady(function(){
    var dateInput = document.getElementById('date');
    var modeInput = document.getElementById('mode');
    var slotsEl   = document.getElementById('slots');
    var slotHelp  = document.getElementById('slotHelp');

    try{ if(slotsEl){ slotsEl.innerHTML=''; } }catch(e){}

    function safeRender(){
      try { if (typeof renderSlots === 'function') { renderSlots(); } }
      catch(e){ console.error(e); }
    }

    if (dateInput){
      dateInput.addEventListener('change',  safeRender);
      dateInput.addEventListener('input',   safeRender);
    }
    if (modeInput){
      modeInput.addEventListener('change', safeRender);
    }

    // první načtení (když je předvyplněné datum)
    if (dateInput && dateInput.value){
      if (slotHelp) slotHelp.textContent = 'Načítám volné časy…';
      safeRender();
    }
  });
})();
</script>
<script id="date-inline-hint-override">
(function(){
  function $(id){ return document.getElementById(id); }

  function ensureHint(){
    var dateInput = $("date");
    if(!dateInput) return null;
    var next = dateInput.nextElementSibling;
    if (next && next.id === "dateHint") return next;
    var div = document.createElement('div');
    div.id = 'dateHint';
    div.className = 'field-hint hidden';
    div.setAttribute('role','status');
    div.setAttribute('aria-live','polite');
    div.innerHTML = '<span class="dot"></span><span></span>';
    dateInput.parentNode.insertBefore(div, dateInput.nextSibling);
    return div;
  }

  function updateDateHint(requested,resolved){
    var dateInput = $('date'); var hint = ensureHint();
    if(!dateInput || !hint) return;
    var span = hint.querySelector('span:last-child');
    if(requested && resolved && requested !== resolved){
      var d = new Date(resolved + 'T00:00:00');
      var pretty = isNaN(+d) ? resolved : d.toLocaleDateString('cs-CZ',{weekday:'short', day:'2-digit', month:'2-digit', year:'numeric'});
      hint.classList.remove('hidden');
      span.innerHTML = 'Vybraný den nelze rezervovat. Nejbližší volný: <strong>'+ pretty +'</strong>.';
      dateInput.classList.add('input-warn');
      dateInput.setAttribute('aria-describedby','dateHint');
    } else {
      hint.classList.add('hidden');
      span.textContent = '';
      dateInput.classList.remove('input-warn');
      dateInput.removeAttribute('aria-describedby');
    }
  }

  // obal fetchSlots: po fetchi promítni stav do hintu
  var _fetchSlots = window.fetchSlots;
  if (typeof _fetchSlots === 'function' && !_fetchSlots.__wrappedHint){
    window.fetchSlots = async function(dateStr, mode){
      var res = await _fetchSlots.apply(this, arguments);
      try{
        var req = (res && res.requestedDate) || dateStr || '';
        var rsl = (res && res.resolvedDate)  || req;
        updateDateHint(req, rsl);
      }catch(e){ console.warn(e); }
      return res;
    };
    window.fetchSlots.__wrappedHint = true;
  }

  // kdyby se fetch dělal uvnitř renderSlots, zkusíme to i tam
  var _renderSlots = window.renderSlots;
  if (typeof _renderSlots === 'function' && !_renderSlots.__wrappedHint){
    window.renderSlots = async function(){
      var before = ($('date')||{}).value || '';
      var out = await _renderSlots.apply(this, arguments);
      try{
        var after = ($('date')||{}).value || '';
        var req = window.__lastRequestedDate || before;
        var rsl = window.__lastResolvedDate  || after;
        updateDateHint(req, rsl);
      }catch(e){ console.warn(e); }
      return out;
    };
    window.renderSlots.__wrappedHint = true;
  }

  // uživatelská změna data → schovej hint (zase se ukáže po fetchi)
  function wire(){
    var el = $('date'); if(!el) return;
    if(el.__wiredHint) return;
    var clear = function(){ updateDateHint(null,null); };
    el.addEventListener('input', clear);
    el.addEventListener('change', clear);
    el.__wiredHint = true;
  }
  if(document.readyState==='loading'){ document.addEventListener('DOMContentLoaded', wire);} else { wire(); }
})();
</script>

<script id="slots-dynamic">
(function(){
  function $(id){ return document.getElementById(id); }
  function debounce(fn,ms){ var t; return function(){ var a=arguments,th=this; clearTimeout(t); t=setTimeout(function(){ fn.apply(th,a); },ms||200); }; }

  var _wired=false, _renderBusy=false, _suppressNext=false;

  function showDateHint(resolvedDate, requestedDate){
    var box=$('dateHint'); if(!box) return;
    if(resolvedDate && requestedDate && resolvedDate!==requestedDate){
      box.innerHTML = "<strong>Nabízím nejbližší volný termín:</strong> "+ resolvedDate +
                      "<div class='mini'>Původně vybraný den byl "+ requestedDate +".</div>";
      box.classList.remove('hidden');
    }else{
      hideDateHint();
    }
  }
  function hideDateHint(){ var box=$('dateHint'); if(box){ box.classList.add('hidden'); box.innerHTML=""; } }

  async function fetchSlots(dateStr, mode){
    if(!dateStr) return { requestedDate:null, resolvedDate:null, slots:[] };
    var SAPI=(window.SLOTS_API||"");
    if(!SAPI) throw new Error("SLOTS_API není nastaveno");
    var dur=(typeof window.SLOT_DURATION_MIN==="number"?window.SLOT_DURATION_MIN:30);
    var tz=window.USER_TZ||(Intl.DateTimeFormat().resolvedOptions().timeZone||"Europe/Prague");
    var qs=new URLSearchParams({date:dateStr,duration:String(dur),tz:tz,mode:String(mode||"remote")});
    var res=await fetch(SAPI+"?"+qs.toString(),{method:"GET"});
    if(!res.ok) throw new Error("HTTP "+res.status);
    var data=await res.json();
    return {
      requestedDate: data.requestedDate||dateStr,
      resolvedDate:  data.resolvedDate ||data.requestedDate||dateStr,
      slots: Array.isArray(data.slots)?data.slots:[]
    };
  }

  async function renderSlots(){
    if(_renderBusy) return; _renderBusy=true;
    var dateInput=$("date"), modeInput=$("mode"), slotsEl=$("slots"), slotInput=$("slot"), slotHelp=$("slotHelp");
    try{
      if(!dateInput||!slotsEl||!slotInput){ _renderBusy=false; return; }
      var dateStr=dateInput.value, mode=(modeInput&&modeInput.value)||"remote";
      slotsEl.innerHTML=""; slotInput.value="";
      if(!dateStr){ if(slotHelp) slotHelp.textContent=""; _renderBusy=false; return; }
      if(slotHelp) slotHelp.textContent="Načítám volné časy…";

      var data=await fetchSlots(dateStr,mode);
      var requestedDate=data.requestedDate, resolvedDate=data.resolvedDate, slots=data.slots||[];

      // Pokud backend posunul den, uprav input, ale nezpůsob další render (suppress)
      if(resolvedDate!==dateInput.value){
        _suppressNext=true;
        dateInput.value=resolvedDate;
        try{
          if(typeof window.view!=="undefined" && typeof window.renderCal==="function"){
            var d=new Date(resolvedDate);
            if(!isNaN(+d)){ view.y=d.getFullYear(); view.m=d.getMonth(); renderCal(); }
          }
        }catch(_){}
        showDateHint(resolvedDate, requestedDate);
      }else{
        hideDateHint();
      }

      if(slotHelp) slotHelp.textContent="";
      if(!slots.length){
        var p=document.createElement("p"); p.className="muted"; p.textContent="Pro tento den nejsou volné časy."; slotsEl.appendChild(p);
        _renderBusy=false; return;
      }

      slots.forEach(function(s){
        var btn=document.createElement("button");
        btn.type="button"; btn.className="slot"; btn.setAttribute("role","option"); btn.setAttribute("aria-pressed","false");
        btn.textContent=s.label||s.time||"—";
        btn.addEventListener("click",function(){
          slotsEl.querySelectorAll(".slot").forEach(function(x){ x.setAttribute("aria-pressed","false"); });
          btn.setAttribute("aria-pressed","true");
          slotInput.value=s.value||s.start||s.time||"";
        });
        slotsEl.appendChild(btn);
      });
    }catch(err){
      console.error(err);
      var slotsEl=$("slots"); if(slotsEl){ slotsEl.innerHTML=""; var p=document.createElement("p"); p.className="muted"; p.textContent="Sloty se nepodařilo načíst."; slotsEl.appendChild(p); }
      if(typeof window.showGlobalError==="function") showGlobalError("Sloty nelze načíst – zkuste to prosím později.");
      var slotHelp=$("slotHelp"); if(slotHelp) slotHelp.textContent="";
    }finally{
      _renderBusy=false;
    }
  }
  window.renderSlots=renderSlots;

  function wireOnce(){
    if(_wired) return; _wired=true;
    var dateInput=$("date"), modeInput=$("mode"), slotsEl=$("slots");
    if(!dateInput||!slotsEl) return;

    var onDateChanged = function(){
      if(_suppressNext){ _suppressNext=false; return; } // přepis z resolvedDate nevyvolá další fetch
      debouncedRender();
    };
    var debouncedRender = debounce(renderSlots, 200);

    // přesně jednou
    if(!dateInput.__wired){ dateInput.addEventListener("change", onDateChanged); dateInput.__wired=true; }
    if(modeInput && !modeInput.__wired){ modeInput.addEventListener("change", debouncedRender); modeInput.__wired=true; }

    // začneme čistě
    slotsEl.innerHTML="";
    if(dateInput.value){ renderSlots(); }
  }

  if(document.readyState==="loading"){ document.addEventListener("DOMContentLoaded", wireOnce); }
  else { wireOnce(); }
})();
</script>



<script id="cal-patch-v2">
(function(){
  if (window.__calPatchV2) return; window.__calPatchV2 = true;

  var modal = document.getElementById('dateModal') || document.querySelector('dialog, [role="dialog"], .modal');
  var dateInput = document.getElementById('date');

  // Uklid dřívějších footerů, které nejsou uvnitř modalu
  document.querySelectorAll('.cal-footer').forEach(function(el){
    if (!modal || !modal.contains(el)) el.remove();
  });

  if (!modal) return;

  function closeModal(){
    // podpora <dialog> i div-based modalů
    if (modal.tagName && modal.tagName.toLowerCase()==='dialog'){
      try { modal.close(); } catch(e){}
      modal.removeAttribute('open');
    }
    modal.classList.add('hidden');
    modal.style.display='none';
    modal.style.opacity='0';
    modal.style.pointerEvents='none';
  }

  function openModal(){
    modal.classList.remove('hidden');
    modal.style.display='grid';
    modal.style.opacity='1';
    modal.style.pointerEvents='auto';
    if (modal.tagName && modal.tagName.toLowerCase()==='dialog'){
      try { modal.showModal && modal.showModal(); } catch(e){}
    }
  }

  // Získání vybraného dne z gridu
  function getPickedIso(){
    // 1) vlastní značení
    var el = modal.querySelector('.cal-day[aria-selected="true"][data-date]');
    if (el && el.dataset.date) return el.dataset.date;
    // 2) různé knihovny:
    var el2 = modal.querySelector('[data-date].day--selected, [data-date][aria-selected="true"]');
    if (el2 && el2.dataset.date) return el2.dataset.date;
    // 3) fallback – vezmi obsah tlačítka a slož datum ze zobrazeného měsíce
    var focused = modal.querySelector('.cal-day[aria-selected="true"], .day--selected, .cal-day:focus');
    var day = focused ? focused.textContent.trim() : '';
    var currentHeader = modal.querySelector('[data-cal-header], .cal-header, h2, h3');
    // pokud to nepůjde spolehlivě, vrať aktuální hodnotu inputu
    return (dateInput && dateInput.value) || '';
  }

  function todayIso(){
    var d=new Date(), m=('0'+(d.getMonth()+1)).slice(-2), da=('0'+d.getDate()).slice(-2);
    return d.getFullYear()+'-'+m+'-'+da;
  }

  function setDateAndClose(iso){
    if (dateInput && iso){
      dateInput.value = iso;
      if (typeof window.renderSlots==='function') { try{ window.renderSlots(); }catch(e){} }
    }
    closeModal();
  }

  // Vytvoř footer uvnitř modalu (pokud chybí)
  function ensureFooter(){
    var footer = modal.querySelector('.cal-footer');
    if (footer) return;

    footer = document.createElement('div');
    footer.className = 'cal-footer';

    var left = document.createElement('div'); left.className = 'cal-actions-left';
    var right= document.createElement('div'); right.className = 'cal-actions-right';

    var bCancel = document.createElement('button');
    bCancel.type='button'; bCancel.className='btn-cal'; bCancel.textContent='Zrušit';
    bCancel.addEventListener('click', function(e){ e.preventDefault(); closeModal(); });

    var bToday  = document.createElement('button');
    bToday.type='button'; bToday.className='btn-cal'; bToday.textContent='Dnes';
    bToday.addEventListener('click', function(e){ e.preventDefault(); setDateAndClose(todayIso()); });

    var bOk     = document.createElement('button');
    bOk.type='button'; bOk.className='btn-cal primary'; bOk.textContent='Vybrat datum';
    bOk.addEventListener('click', function(e){ e.preventDefault(); setDateAndClose(getPickedIso()); });

    left.appendChild(bCancel);
    right.appendChild(bToday);
    right.appendChild(bOk);
    footer.appendChild(left);
    footer.appendChild(right);

    // přilep na konec obsahu modalu
    modal.appendChild(footer);
  }

  ensureFooter();

  // ESC => zavřít
  document.addEventListener('keydown', function(e){
    if (e.key === 'Escape' && !modal.classList.contains('hidden')) closeModal();
    if (e.key === 'Enter' && !modal.classList.contains('hidden')){
      e.preventDefault(); setDateAndClose(getPickedIso());
    }
  });

  // Klik mimo obsah (overlay) => zavřít (jen když overlay je přímo modal)
  modal.addEventListener('click', function(e){
    if (e.target === modal) closeModal();
  });

  // Export helperů pro stávající kód (kdyby bylo potřeba)
  window.__calClose = closeModal;
  window.__calOpen  = openModal;
})();
</script>
  <script src="burger-hotfix.js"></script>

<script>
(function(){
  const burger = document.getElementById('burger');
  const drawer = document.getElementById('mobileMenu');

  if (!burger || !drawer) return;

  function openDrawer() {
    drawer.hidden = false;
    burger.setAttribute('aria-expanded', 'true');
    setTimeout(() => document.addEventListener('click', onDocClick), 0);
  }
  function closeDrawer() {
    drawer.hidden = true;
    burger.setAttribute('aria-expanded', 'false');
    document.removeEventListener('click', onDocClick);
  }
  function onDocClick(e) {
    if (!drawer.contains(e.target) && e.target !== burger) closeDrawer();
  }

  burger.addEventListener('click', (e) => {
    e.stopPropagation();
    (drawer.hidden ? openDrawer : closeDrawer)();
  });

  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && !drawer.hidden) closeDrawer();
  });

  drawer.querySelectorAll('a').forEach(a => {
    a.addEventListener('click', () => closeDrawer());
  });
})();
</script>

</body>
</html>
<script>
(function(){
  const modal   = document.getElementById('dateModal');
  const grid    = document.getElementById('calGrid');
  const actions = modal?.querySelector('.cal-actions');
  const dateInp = document.getElementById('date');
  if (!modal || !grid || !actions || !dateInp) return;

  // 1) Ukliď zbloudilé akce mimo modal (dřívější injekce)
  document.querySelectorAll('body > .cal-actions, body > .cal-footer, body > .cal-actions-left, body > .cal-actions-right')
    .forEach(n => n.remove());

  // 2) Přestav akční řádek v modalu: vlevo Zrušit, vpravo Dnes + Vybrat datum
  let left  = document.createElement('div');  left.className  = 'cal-actions-left';
  let right = document.createElement('div'); right.className = 'cal-actions-right';

  const btnCancel = document.getElementById('calCancel');
  const btnToday  = document.getElementById('calToday');

  let btnConfirm = document.getElementById('calConfirm');
  if (!btnConfirm) {
    btnConfirm = document.createElement('button');
    btnConfirm.id = 'calConfirm';
    btnConfirm.type = 'button';
    btnConfirm.className = 'btn primary';
    btnConfirm.textContent = 'Vybrat datum';
  }

  actions.innerHTML = '';
  if (btnCancel) left.appendChild(btnCancel);
  if (btnToday)  right.appendChild(btnToday);
  right.appendChild(btnConfirm);
  actions.append(left, right);

  // 3) Výběr dne = jen označit (neuzavírat)
  let pickedISO = null;
  function markSelected(btn){
    grid.querySelectorAll('.cal-day[aria-selected="true"]').forEach(b => b.setAttribute('aria-selected','false'));
    btn.setAttribute('aria-selected','true');
    pickedISO = btn.dataset.iso || btn.getAttribute('data-iso');
  }
  grid.addEventListener('click', (e) => {
    const btn = e.target.closest('.cal-day');
    if (!btn) return;
    // zruš původní onClick, který modal zavíral
    e.preventDefault(); 
    e.stopImmediatePropagation();
    markSelected(btn);
  }, true); // capture = true, ať chytíme dřív než starý handler

  // 4) Zavírání
  function closeModal(){
    modal.removeAttribute('open');
    modal.classList.remove('modalopen');
    modal.style.display = '';
    modal.style.visibility = '';
    modal.style.opacity = '';
    modal.style.pointerEvents = '';
  }
  btnCancel?.addEventListener('click', closeModal);
  btnConfirm.addEventListener('click', () => {
    if (pickedISO) {
      dateInp.value = pickedISO;
      if (typeof renderSlots === 'function') { try { renderSlots(); } catch(_){} }
    }
    closeModal();
  });
  modal.addEventListener('click', (e) => { if (e.target === modal) closeModal(); });
})();
</script>
<style id="cal-contrast-and-actions-patch">
  /* --- Lepší kontrast navigačních šipek v datepickeru --- */
  .cal-nav-btn {
    color: #e5e7eb;                 /* světlejší ikona na dark backgroundu */
    border: 1px solid rgba(255,255,255,.22);
    background: rgba(255,255,255,.06);
    box-shadow: 0 2px 8px rgba(0,0,0,.25);
  }
  .cal-nav-btn:hover,
  .cal-nav-btn:focus-visible {
    color: #ffffff;
    border-color: rgba(255,255,255,.35);
    background: rgba(255,255,255,.10);
    outline: none;
  }
  .cal-nav-btn svg,
  .cal-nav-btn svg * { fill: currentColor !important; stroke: currentColor !important; }

  /* --- Akční lišta v modalu: Zrušit vlevo, ostatní vpravo --- */
  #dateModal .cal-actions {
    display: flex;
    align-items: center;
    gap: .5rem;
    padding: .75rem 1rem;
  }
  #dateModal .cal-actions-left  { margin-right: auto; display:flex; gap:.5rem; }
  #dateModal .cal-actions-right { margin-left:  auto; display:flex; gap:.5rem; }
</style>

<script>
/* Naváže zvýraznění na šipky v hlavičce kalendáře a jistí zarovnání akcí */
(function(){
  var modal = document.getElementById('dateModal');
  if (!modal) return;

  // Označ navigační šipky jednotnou třídou .cal-nav-btn (pro vyšší kontrast)
  var head = modal.querySelector('.cal-head, .cal-header, .modal-head') || modal.querySelector('[class*="head"]');
  if (head) {
    var headBtns = head.querySelectorAll('button');
    if (headBtns.length >= 2) {
      headBtns[0].classList.add('cal-nav-btn');
      headBtns[headBtns.length - 1].classList.add('cal-nav-btn');
    }
  }

  // Jisti zarovnání akčních tlačítek (Zrušit vlevo; Dnes + Vybrat datum vpravo)
  var actions = modal.querySelector('.cal-actions');
  if (actions) {
    var left = actions.querySelector('.cal-actions-left');
    var right = actions.querySelector('.cal-actions-right');
    if (!left)  { left  = document.createElement('div'); left.className  = 'cal-actions-left';  actions.prepend(left); }
    if (!right) { right = document.createElement('div'); right.className = 'cal-actions-right'; actions.append(right); }

    var btnCancel = actions.querySelector('#calCancel');
    var btnToday  = actions.querySelector('#calToday');
    var btnConfirm= actions.querySelector('#calConfirm');

    if (btnCancel && btnCancel.parentElement !== left)  left.prepend(btnCancel);
    if (btnToday  && btnToday.parentElement  !== right) right.append(btnToday);
    if (btnConfirm&& btnConfirm.parentElement!== right) right.append(btnConfirm);
  }
})();
</script>
